!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.microsoftTeams=e()}(this,function(){String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t});var t;return function(t){"use strict";function e(t){for(var e="^",n=t.split("."),i=0;i<n.length;i++)e+=(i>0?"[.]":"")+n[i].replace("*","[^/^.]+");return e+="$"}function n(t){for(var n="",i=0;i<t.length;i++)n+=(0===i?"":"|")+e(t[i]);return new RegExp(n)}function i(){if(!G){G=!0,_=this._window||window;var t=function(t){return T(t)};j=_.parent!==_.self?_.parent:_.opener,j?_.addEventListener("message",t,!1):(Q=!0,window.onNativeMessage=E);try{J="*";var e=B(j,"initialize",[F]);nt[e]=function(t,e){Y=t,$=e}}finally{J=null}this._uninitialize=function(){Y&&(s(null),c(null),l(null)),Y===V.settings&&at.registerOnSaveHandler(null),Y===V.remove&&at.registerOnRemoveHandler(null),Q||_.removeEventListener("message",t,!1),G=!1,j=null,J=null,Z=[],K=null,X=null,tt=[],et=0,nt={},Y=null,$=null,Q=!1}}}function o(){it||(it=!0,C(),document.addEventListener("keydown",function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(t.print(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))}function r(){window.print()}function a(t){C();var e=B(j,"getContext");nt[e]=t}function s(t){C(),q=t}function u(t){q&&q(t),K&&B(K,"themeChange",[t])}function c(t){C(),ot=t}function f(t){ot&&ot(t)}function l(t){C(),rt=t}function h(){rt&&rt()||d()}function d(){C();var t=B(j,"navigateBack",[]);nt[t]=function(t){if(!t)throw new Error("Back navigation is not supported in the current client or context.")}}function v(t){C(V.content,V.settings,V.remove,V.task);var e=B(j,"navigateCrossDomain",[t]);nt[e]=function(t){if(!t)throw new Error("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.")}}function g(t,e){C();var n=B(j,"getTabInstances",[e]);nt[n]=t}function p(t,e){C();var n=B(j,"getUserJoinedTeams",[e]);nt[n]=t}function m(t,e){C();var n=B(j,"getMruTabInstances",[e]);nt[n]=t}function y(t){C(V.content),B(j,"shareDeepLink",[t.subEntityId,t.subEntityLabel,t.subEntityWebUrl])}function w(t){C(V.content);var e=[t.entityId,t.title,t.description,t.type,t.objectUrl,t.downloadUrl,t.webPreviewUrl,t.webEditUrl,t.baseUrl,t.editFile,t.subEntityId];B(j,"openFilePreview",e)}function b(t){C();var e=B(j,"uploadCustomApp",[t]);nt[e]=function(t,e){if(!t)throw new Error(e)}}function k(t){C();var e=B(j,"navigateToTab",[t]);nt[e]=function(t){if(!t)throw new Error("Invalid internalTabInstanceId and/or channelId were/was provided")}}function C(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!G)throw new Error("The library has not yet been initialized");if(Y&&t&&t.length>0){for(var n=!1,i=0;i<t.length;i++)if(t[i]===Y){n=!0;break}if(!n)throw new Error("This call is not allowed in the '"+Y+"' context")}}function T(t){if(t&&t.data&&"object"==typeof t.data){var e=t.source||t.originalEvent.source,n=t.origin||t.originalEvent.origin;e===_||n!==_.location.origin&&!z.test(n.toLowerCase())||(I(e,n),e===j?E(t):e===K&&M(t))}}function I(t,e){j&&t!==j?K&&t!==K||(K=t,X=e):(j=t,J=e),j&&j.closed&&(j=null,J=null),K&&K.closed&&(K=null,X=null),U(j),U(K)}function E(t){if("id"in t.data){var e=t.data,n=nt[e.id];n&&(n.apply(null,e.args),delete nt[e.id])}else if("func"in t.data){var e=t.data,i=R[e.func];i&&i.apply(this,e.args)}}function M(t){if("id"in t.data&&"func"in t.data){var e=t.data,n=R[e.func];if(n){var i=n.apply(this,e.args);i&&O(K,e.id,Array.isArray(i)?i:[i])}else{var o=B(j,e.func,e.args);nt[o]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];K&&O(K,e.id,t)}}}}function S(t){return t===j?Z:t===K?tt:[]}function N(t){return t===j?J:t===K?X:null}function U(t){for(var e=N(t),n=S(t);t&&e&&n.length>0;)t.postMessage(n.shift(),e)}function A(t,e){var n=_.setInterval(function(){0===S(t).length&&(clearInterval(n),e())},100)}function B(t,e,n){var i=P(e,n);if(Q)_&&_.nativeInterface&&_.nativeInterface.framelessPostMessage(JSON.stringify(i));else{var o=N(t);t&&o?t.postMessage(i,o):S(t).push(i)}return i.id}function L(t,e){return C(),B(j,t,e)}function O(t,e,n){var i=H(e,n),o=N(t);t&&o&&t.postMessage(i,o)}function P(t,e){return{id:et++,func:t,args:e||[]}}function H(t,e){return{id:t,args:e||[]}}function x(t){C();var e=B(j,"getChatMembers");nt[e]=t}var D,F="1.3.6",W=["https://teams.microsoft.com","https://teams.microsoft.us","https://int.teams.microsoft.com","https://devspaces.skype.com","https://ssauth.skype.com","http://dev.local","https://msft.spoppe.com","https://*.sharepoint.com","https://*.sharepoint-df.com","https://*.sharepointonline.com","https://outlook.office.com","https://outlook-sdf.office.com"],z=n(W),R={},V={settings:"settings",content:"content",authentication:"authentication",remove:"remove",task:"task"};!function(t){function e(t,e){C(),l=e,B(j,"setUpViews",[t])}function n(t){l&&l(t)||(C(),B(j,"viewConfigItemPress",[t]))}function i(t,e){C(),c=e,B(j,"setNavBarMenu",[t])}function o(t){c&&c(t)||(C(),B(j,"handleNavBarMenuItemPress",[t]))}function r(t,e){C(),f=e,B(j,"showActionMenu",[t])}function a(t){f&&f(t)||(C(),B(j,"handleActionMenuItemPress",[t]))}var s=function(){function t(){this.enabled=!0}return t}();t.MenuItem=s;var u;!function(t){t.dropDown="dropDown",t.popOver="popOver"}(u=t.MenuListType||(t.MenuListType={}));var c;R.navBarMenuItemPress=o;var f;R.actionMenuItemPress=a;var l;R.setModuleView=n,t.setUpViews=e,t.setNavBarMenu=i,t.showActionMenu=r}(D=t.menus||(t.menus={}));var _,j,J,K,X,Y,$,q,G=!1,Q=!1,Z=[],tt=[],et=0,nt={},it=!1;R.themeChange=u;var ot;R.fullScreenChange=f;var rt;R.backButtonPress=h,t.initialize=i,t.enablePrintCapability=o,t.print=r,t.getContext=a,t.registerOnThemeChangeHandler=s,t.registerFullScreenHandler=c,t.registerBackButtonHandler=l,t.navigateBack=d,t.navigateCrossDomain=v,t.getTabInstances=g,t.getUserJoinedTeams=p,t.getMruTabInstances=m,t.shareDeepLink=y,t.openFilePreview=w,t.uploadCustomApp=b,t.navigateToTab=k;var at;!function(t){function e(t){C(V.settings,V.remove),B(j,"settings.setValidityState",[t])}function n(t){C(V.settings,V.remove);var e=B(j,"settings.getSettings");nt[e]=t}function i(t){C(V.settings),B(j,"settings.setSettings",[t])}function o(t){C(V.settings),u=t}function r(t){C(V.remove),c=t}function a(t){var e=new f(t);u?u(e):e.notifySuccess()}function s(){var t=new l;c?c(t):t.notifySuccess()}var u,c;R["settings.save"]=a,R["settings.remove"]=s,t.setValidityState=e,t.getSettings=n,t.setSettings=i,t.registerOnSaveHandler=o,t.registerOnRemoveHandler=r;var f=function(){function t(t){this.notified=!1,this.result=t?t:{}}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),B(j,"settings.save.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),B(j,"settings.save.failure",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},t}(),l=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),B(j,"settings.remove.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),B(j,"settings.remove.failure",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},t}()}(at=t.settings||(t.settings={}));var st;!function(t){function e(t){g=t}function n(t){var e=void 0!==t?t:g;if(C(V.content,V.settings,V.remove,V.task),"desktop"===$){var n=document.createElement("a");n.href=e.url;var i=B(j,"authentication.authenticate",[n.href,e.width,e.height]);nt[i]=function(t,n){t?e.successCallback(n):e.failureCallback(n)}}else a(e)}function i(t){C();var e=B(j,"authentication.getAuthToken",[t.resources]);nt[e]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}}function o(t){C();var e=B(j,"authentication.getUser");nt[e]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}}function r(){s();try{K&&K.close()}finally{K=null,X=null}}function a(t){g=t,r();var e=g.width||600,n=g.height||400;e=Math.min(e,_.outerWidth-400),n=Math.min(n,_.outerHeight-200);var i=document.createElement("a");i.href=g.url;var o="undefined"!=typeof _.screenLeft?_.screenLeft:_.screenX,a="undefined"!=typeof _.screenTop?_.screenTop:_.screenY;o+=_.outerWidth/2-e/2,a+=_.outerHeight/2-n/2,K=_.open(i.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+a+", left="+o+", width="+e+", height="+n),K?u():h("FailedToOpenWindow")}function s(){p&&(clearInterval(p),p=0),delete R.initialize,delete R.navigateCrossDomain}function u(){s(),p=_.setInterval(function(){if(!K||K.closed)h("CancelledByUser");else{var t=X;try{X="*",B(K,"ping")}finally{X=t}}},100),R.initialize=function(){return[V.authentication,$]},R.navigateCrossDomain=function(t){return!1}}function c(t,e){d(e,"result",t),C(V.authentication),B(j,"authentication.authenticate.success",[t]),A(j,function(){return setTimeout(function(){return _.close()},200)})}function f(t,e){d(e,"reason",t),C(V.authentication),B(j,"authentication.authenticate.failure",[t]),A(j,function(){return setTimeout(function(){return _.close()},200)})}function l(t){try{g&&g.successCallback&&g.successCallback(t)}finally{g=null,r()}}function h(t){try{g&&g.failureCallback&&g.failureCallback(t)}finally{g=null,r()}}function d(t,e,n){if(t){var i=document.createElement("a");i.href=decodeURIComponent(t),i.host&&i.host!==window.location.host&&"outlook.office.com"===i.host&&i.search.indexOf("client_type=Win32_Outlook")>-1&&(e&&"result"===e&&(n&&(i.href=v(i.href,"result",n)),_.location.assign(v(i.href,"authSuccess",""))),e&&"reason"===e&&(n&&(i.href=v(i.href,"reason",n)),_.location.assign(v(i.href,"authFailure",""))))}}function v(t,e,n){var i=t.indexOf("#"),o=i===-1?"#":t.substr(i);return o=o+"&"+e+(""!==n?"="+n:""),t=i===-1?t:t.substr(0,i),t+o}var g,p;R["authentication.authenticate.success"]=l,R["authentication.authenticate.failure"]=h,t.registerAuthenticationHandlers=e,t.authenticate=n,t.getAuthToken=i,t.getUser=o,t.notifySuccess=c,t.notifyFailure=f}(st=t.authentication||(t.authentication={})),t.sendCustomMessage=L;var ut;!function(t){function e(t,e){C(V.content);var n=B(j,"tasks.startTask",[t]);nt[n]=e}function n(t,e){C(V.content,V.task),B(j,"tasks.completeTask",[t,Array.isArray(e)?e:[e]])}t.startTask=e,t.submitTask=n}(ut=t.tasks||(t.tasks={})),t.getChatMembers=x}(t||(t={})),t});